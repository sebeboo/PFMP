<!DOCTYPE html>


<html>
<head>
  <script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
  <script src="https://jsuites.net/v4/jsuites.js"></script>
  <link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
  <link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />
</head>

<body>
  <div id="spreadsheet"></div>

    <script>
      function makeApiCall() {
        var params = {
          // The ID of the spreadsheet to retrieve data from.
          spreadsheetId: '1lmpMg7YRtLIe0k79s0pI0pcWLsq2kWNm5rP4b5Yc9s4',  // TODO: Update placeholder value.
  
          // The A1 notation of the values to retrieve.
          range: 'export',  // TODO: Update placeholder value.
  
          // How values should be represented in the output.
          // The default render option is ValueRenderOption.FORMATTED_VALUE.
          valueRenderOption: 'FORMATTED_VALUE',  // TODO: Update placeholder value.
  
          // How dates, times, and durations should be represented in the output.
          // This is ignored if value_render_option is
          // FORMATTED_VALUE.
          // The default dateTime render option is [DateTimeRenderOption.SERIAL_NUMBER].
          dateTimeRenderOption: 'SERIAL_NUMBER',  // TODO: Update placeholder value.
        };
  
        var request = gapi.client.sheets.spreadsheets.values.get(params);
        request.then(function(response) {
          // TODO: Change code below to process the `response` object:
          console.log(response.result);
        }, function(reason) {
          console.error('error: ' + reason.result.error.message);
        });
      }
  
      function initClient() {
        var API_KEY = 'AIzaSyDxlPIPWkDlkzVkyQmWeEZxvP4J2FROvRs'; 
        var CLIENT_ID = '306806233180-4s8vejs2q744juc1u6cq99sss0f316nn.apps.googleusercontent.com';  
        // TODO: Authorize using one of the following scopes:
        //   'https://www.googleapis.com/auth/drive'
        //   'https://www.googleapis.com/auth/drive.file'
        //   'https://www.googleapis.com/auth/drive.readonly'
        //   'https://www.googleapis.com/auth/spreadsheets'
        //   'https://www.googleapis.com/auth/spreadsheets.readonly'
        var SCOPE = 'https://www.googleapis.com/auth/spreadsheets.readonly';
  
        gapi.client.init({
          'apiKey': API_KEY,
          'clientId': CLIENT_ID,
          'scope': SCOPE,
          'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
        }).then(function() {
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
          updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        });
      }
  
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }
  
      function updateSignInStatus(isSignedIn) {
        if (isSignedIn) {
          makeApiCall();
        }
      }
  
      function handleSignInClick(event) {
        gapi.auth2.getAuthInstance().signIn();
      }
  
      function handleSignOutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
      }
      </script>
      <script async defer src="https://apis.google.com/js/api.js"
        onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
      </script>
      <button id="signin-button" onclick="handleSignInClick()">Sign in</button>
      <button id="signout-button" onclick="handleSignOutClick()">Sign out</button>



</body>


<script>
  var data = [
    ['2MPMIA', '30', '20'],
    ['2SLAH1', '100', '90'],
];

jspreadsheet(document.getElementById('spreadsheet'), {
    data:data,
    columns: [
        { type: 'text', title:'Classe', width:120 },
        { type: 'text', title:'Fiche de liaison', width:200, },
        { type: 'text', title:'Convention', width:200 }
     ]
});

//var spreadsheet_id = '1lmpMg7YRtLIe0k79s0pI0pcWLsq2kWNm5rP4b5Yc9s4';
//var api_key = 'AIzaSyDxlPIPWkDlkzVkyQmWeEZxvP4J2FROvRs';
//var id_client = '306806233180-4s8vejs2q744juc1u6cq99sss0f316nn.apps.googleusercontent.com' ;
//var secret = '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';

</script>
</html>




